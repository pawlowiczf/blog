{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"2025/08/21/proto-repository/","title":"Setup remote repository for <code>.proto</code> and <code>gRPC</code> files","text":"<p>In a microservices architecture, Protobuf files and generated stubs are often used by different services located in separate repositories. How can we share them across applications while keeping them consistent? How can we establish a single source of truth, streamline modifications, and automate deployment?</p> <p>Project files: schema-definitions-repository</p>"},{"location":"2025/08/21/proto-repository/#design-proposal","title":"Design proposal","text":"<p>We'll create a single Git repository to store all Proto files, serving as the single source of truth. Next, we'll set up a server using a cloud provider (e.g., AWS or GCP). In these instructions, we use GCP Compute Engine, but any server with a public IP and the ability to run Docker containers would work. </p> <p>On that server, we would run a Nexus repository, which stores generated code by Proto compiler. In addition, we will add Github Actions CI to detect changes in Git repository, compile Proto files and push/upload artifacts to Nexus.  </p>"},{"location":"2025/08/21/proto-repository/#configure-server-using-cloud-provider","title":"Configure server using cloud provider","text":"<ol> <li>Set up a <code>Compute Engine</code> instance in GCP using the Ubuntu operating system. Select an appropriate machine type, with minimum specifications of 2vCPUs, 4\u202fGB RAM, and 10\u202fGB disk space. I've used <code>e2-medium</code> machine and it worked fine. Allow HTTP and HTTPS connections. </li> <li>Set up <code>Firewall rule</code> in a different section and assign it to proper network. <code>Firewall rule</code> must allow external traffic coming on port <code>80</code> (add also <code>443</code>).</li> <li>Generate SSH keys using <code>ssh-keygen</code> command. It it possible to create an universal keys that would work for every VM instances, but it is more secure to add a key directly to just one VM. Edit VM instance, find SSH section and add public key there. </li> <li>Connect to instance using SSH and private key (for example with <code>Termius</code>) and do following:</li> <li>create new directory <code>nexus</code> with: <code>mkdir nexus</code> and <code>cd nexus</code></li> <li>create new file and paste this content: <code>nano docker-compose.yaml</code>. </li> </ol> <pre><code>\n</code></pre> <ul> <li>install <code>Docker</code> and <code>docker compose</code> with this tutorial</li> <li>run service <code>docker compose run -d</code></li> </ul>"},{"location":"2025/08/21/proto-repository/#create-git-repository","title":"Create Git repository","text":"<p>```xml title=\"pom.xml\"  <pre><code>&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n&lt;groupId&gt;com.repository&lt;/groupId&gt;\n&lt;artifactId&gt;protos&lt;/artifactId&gt;\n&lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n&lt;packaging&gt;jar&lt;/packaging&gt;\n\n&lt;properties&gt;\n    &lt;java.version&gt;21&lt;/java.version&gt;\n&lt;/properties&gt;\n\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.google.protobuf&lt;/groupId&gt;\n        &lt;artifactId&gt;protobuf-java&lt;/artifactId&gt;\n        &lt;version&gt;4.32.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n        &lt;artifactId&gt;grpc-netty-shaded&lt;/artifactId&gt;\n        &lt;version&gt;1.74.0&lt;/version&gt;\n        &lt;scope&gt;runtime&lt;/scope&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n        &lt;artifactId&gt;grpc-protobuf&lt;/artifactId&gt;\n        &lt;version&gt;1.74.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n        &lt;artifactId&gt;grpc-stub&lt;/artifactId&gt;\n        &lt;version&gt;1.74.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;javax.annotation&lt;/groupId&gt;\n        &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;\n        &lt;version&gt;1.3.2&lt;/version&gt;\n    &lt;/dependency&gt;\n\n&lt;/dependencies&gt;\n\n&lt;distributionManagement&gt;\n    &lt;snapshotRepository&gt;\n        &lt;id&gt;nexus-snapshots&lt;/id&gt;\n        &lt;url&gt;${secrets.NEXUS_URL}/repository/maven-snapshots/&lt;/url&gt;\n    &lt;/snapshotRepository&gt;\n    &lt;repository&gt;\n        &lt;id&gt;nexus-releases&lt;/id&gt;\n        &lt;url&gt;${secrets.NEXUS_URL}/repository/maven-releases/&lt;/url&gt;\n    &lt;/repository&gt;\n&lt;/distributionManagement&gt;\n\n&lt;build&gt;\n\n    &lt;plugins&gt;\n\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.11.0&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;${java.version}&lt;/source&gt; \n                &lt;target&gt;${java.version}&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.3.0&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;archive&gt;\n                    &lt;manifest&gt;\n                        &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;\n                    &lt;/manifest&gt;\n                &lt;/archive&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.1.1&lt;/version&gt;\n        &lt;/plugin&gt;\n\n    &lt;/plugins&gt;\n\n&lt;/build&gt;\n</code></pre> <p></p> <pre><code>\n```xml title=\"pom-validate.xml\"\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 \n                             http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.repository&lt;/groupId&gt;\n    &lt;artifactId&gt;protos&lt;/artifactId&gt;\n    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;21&lt;/java.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.google.protobuf&lt;/groupId&gt;\n            &lt;artifactId&gt;protobuf-java&lt;/artifactId&gt;\n            &lt;version&gt;4.32.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n            &lt;artifactId&gt;grpc-netty-shaded&lt;/artifactId&gt;\n            &lt;version&gt;1.74.0&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n            &lt;artifactId&gt;grpc-protobuf&lt;/artifactId&gt;\n            &lt;version&gt;1.74.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.grpc&lt;/groupId&gt;\n            &lt;artifactId&gt;grpc-stub&lt;/artifactId&gt;\n            &lt;version&gt;1.74.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.annotation&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;\n            &lt;version&gt;1.3.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n\n        &lt;plugins&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.11.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;${java.version}&lt;/source&gt; \n                    &lt;target&gt;${java.version}&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.3.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;archive&gt;\n                        &lt;manifest&gt;\n                            &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;\n                        &lt;/manifest&gt;\n                    &lt;/archive&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n        &lt;/plugins&gt;\n\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>"},{"location":"archive/2025/","title":"2025","text":""},{"location":"category/devops/","title":"DevOps","text":""}]}